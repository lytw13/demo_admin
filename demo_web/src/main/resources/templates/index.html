<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>lytw13 | 首页</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- 图标-->
    <link rel="shortcut icon" th:href="@{/img/favicon.ico}">
    
    <!-- 核心CSS-->
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/font-awesome.min.css}">
    
    <!-- 默认样式表-->
    <link rel="stylesheet" th:href="@{/css/AdminLTE.css}">
    <link rel="stylesheet" th:href="@{/css/skins/skin-blue.min.css}">

	<link rel="stylesheet" th:href="@{/layui/css/layui.css}" type="text/css" >

	<!-- 自定义样式-->
    <link rel="stylesheet" th:href="@{/css/customer/custom.css}">


   
  </head>
  
  
<body class="hold-transition skin-blue sidebar-mini">
	<div class="wrapper">
		<div th:insert="common/common :: top"></div>
		<div th:insert="common/common :: sidebar"></div>
			<div class="content-wrapper">
		    <section class="content-header">
		      <ol class="breadcrumb">
		        <li><a th:href="@{/index}" class="active"><i class="fa fa-dashboard"></i> 首页</a></li>
		      </ol>
		    </section>
          	
				<section class="content" style="margin-top:30px">
					<!-- Small boxes (Stat box) -->
					<div class="row">
						<div class="col-lg-3 col-xs-6">
							<!-- small box -->
							<div class="small-box bg-aqua">
								<div class="inner">
									<h3 id="userCount"></h3>

									<p>网站用户数量</p>
								</div>
								<div class="icon">
									<i class="ion ion-bag"></i>
								</div>
								<a th:href="@{/user/listPage}" class="small-box-footer">查看详情<i class="fa fa-arrow-circle-right"></i></a>
							</div>
						</div>
						<!-- ./col -->
						<div class="col-lg-3 col-xs-6">
							<!-- small box -->
							<div class="small-box bg-green">
								<div class="inner">
									<h3>53<sup style="font-size: 20px">%</sup></h3>

									<p>Bounce Rate</p>
								</div>
								<div class="icon">
									<i class="ion ion-stats-bars"></i>
								</div>
								<a href="#" class="small-box-footer">查看更多<i class="fa fa-arrow-circle-right"></i></a>
							</div>
						</div>
						<!-- ./col -->
						<div class="col-lg-3 col-xs-6">
							<!-- small box -->
							<div class="small-box bg-yellow">
								<div class="inner">
									<h3>44</h3>

									<p>User Registrations</p>
								</div>
								<div class="icon">
									<i class="ion ion-person-add"></i>
								</div>
								<a href="#" class="small-box-footer">查看更多<i class="fa fa-arrow-circle-right"></i></a>
							</div>
						</div>
						<!-- ./col -->
						<div class="col-lg-3 col-xs-6">
							<!-- small box -->
							<div class="small-box bg-red">
								<div class="inner">
									<h3>65</h3>

									<p>Unique Visitors</p>
								</div>
								<div class="icon">
									<i class="ion ion-pie-graph"></i>
								</div>
								<a href="#" class="small-box-footer">查看更多<i class="fa fa-arrow-circle-right"></i></a>
							</div>
						</div>
						<!-- ./col -->
					</div>
					<!-- /.row -->
					 <div id="main" style="width: 50%;height:200px;"></div>
						<h2 style="text-align: center">lytw13公告</h2>
					 	<ol id="noticeList">
					 	</ol>
				</section>
			</div>
			
			
			<footer th:insert="common/common :: footer"></footer>
			<div class="control-sidebar-bg"></div>
			</div>
	
	 <!-- js基础文件-->
    <script th:src="@{/js/jquery-3.4.1.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/app.min.js}"></script>
    
    <script th:src="@{/js/echart/echarts.min.js}"></script>

	<!-- layer弹框插件 -->
	<script th:src="@{/js/layer/layer.js}"></script>
    
    <script type="text/javascript">
    	$(document).ready(function(){

			$.ajax({
				url: "/notice/showNotice",
				type: "post",
				success: function(data) {
					openNotice(data);
				}
			});

			function openNotice(data) {
				     layer.open({
				        type: 0,
				        title: "系统公告",
				        area: '500px',
				        shade: 0.8,
				        content: data.content
				    });
			}

			$.ajax({
				url: "/user/getTotal",
				type: "post",
				success: function(data) {
					$("#userCount").text(data);
				}
			});

    		var arr=[];
    		$.ajax({
          	   url: "/user/totalBySex",
          	   type: "post",
          	   success: function(data) {
          		var json = eval(data);
          		$.each(json,function(key,value){
          			var obj = new Object();
          			obj.value = value;
          			obj.name = key;
          			arr.push(obj);
          		});
          	   }
          	 });
    	 // alert(arr);
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));

        var option = {
        			    title : {
        			        text: 'lytw13网站用户男女所占比例',
        			        x:'center'
        			    },
        			    tooltip : {
        			        trigger: 'item',
        			        formatter: "{a} <br/>{b} : {c} ({d}%)"
        			    },
        			    legend: {
        			        orient: 'vertical',
        			        left: 'left',
        			        data: ['男生','女生']
        			    },
        			    series : [
        			        {
        			            name: '男女生所占比例',
        			            type: 'pie',
        			            radius : '60%',  //大小可以理解为
        			            center: ['50%', '60%'],  //第一项是相对于容器宽度，第二项是相对于容器高度。
        			            data:arr,
        			            itemStyle: {
        			                emphasis: {
        			                    shadowBlur: 10,
        			                    shadowOffsetX: 0,
        			                    shadowColor: 'rgba(0, 0, 0, 0.5)'
        			                }
        			            }
        			        }
        			    ]
        			};
        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        myChart.on("click", function(params) {
        	console.log(params.name);
        	window.location.href="/user/listPage";
        });
        var notices=[];
        $.ajax({
       	   url: "/notice/list",
       	   type: "post",
       	   success: function(data) {
       		var json = eval(data);
       		$.each(json,function(key,value){
				$("#noticeList").append("<li value='"+ value.name+"'>"+value.content+"</li>");

      		})
       	   }
       	 });
        
        
    	});
    </script>
</body>
</html>